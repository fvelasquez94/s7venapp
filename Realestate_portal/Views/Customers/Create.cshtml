@model Realestate_portal.Models.Tb_Customers
@using Realestate_portal.Models
@{
    ViewBag.Title = "Premium Group Realty";


    List<Sys_Users> agents = ViewBag.userslist;
    List<Tb_Source> source = ViewBag.lstSource;
    List<Tb_Status> m_status = ViewBag.lstStatus;

}

<div id="basic-non-sticky-notification-content" class="toastify-content hidden flex">
    <i class="text-theme-20" data-feather="check-circle"></i>
    <div class="ml-4 mr-4">
        <div class="font-medium">Data saved successfully!</div>

    </div>
</div>
<div class="intro-y flex items-center mt-8">
    <h2 class="text-lg font-medium mr-auto">
        New Lead
    </h2>
</div>
<div class="grid grid-cols-12 gap-12 mt-5">
    <div class="intro-y col-span-12 lg:col-span-12">
        <!-- BEGIN: Input -->
        @using (Html.BeginForm())
        {
            @Html.AntiForgeryToken()
            <div class="intro-y box">
                <div class="flex flex-col sm:flex-row items-center p-5 border-b border-gray-200 dark:border-dark-5">
                    <h2 class="font-medium text-base mr-auto">
                        Create new Lead
                    </h2>
                </div>
                <div id="input" class="p-5">
                    <div class="preview">
                        <div>
                            <label for="Name" class="form-label">Name</label>
                            <input id="Name" name="Name" type="text" class="form-control" placeholder="" required>
                        </div>
                        <div>
                            <label for="LastName" class="form-label">Last Name</label>
                            <input id="LastName" name="LastName" type="text" class="form-control" placeholder="" required>
                        </div>
                        <div>
                            <label for="Email" class="form-label">Email</label>
                            <input id="Email" name="Email" type="email" class="form-control" placeholder="" required>
                        </div>               
                        <div>
                            <label for="Phone" class="form-label">Phone</label>
                            <input id="Phone" name="Phone" type="text" class="form-control" placeholder="" required>
                        </div>          
                        <div>
                            <label for="Address" class="form-label">Address</label>
                            <input id="Address" name="Address" type="text" class="form-control" placeholder="">
                        </div>               
                        <div>
                            <label for="State" class="form-label">State</label>
                            <select class="form-control" id="State" name="State">
                                <option value="AL">Alabama</option>
                                <option value="AK">Alaska</option>
                                <option value="AZ">Arizona</option>
                                <option value="AR">Arkansas</option>
                                <option value="CA">California</option>
                                <option value="CO">Colorado</option>
                                <option value="CT">Connecticut</option>
                                <option value="DE">Delaware</option>
                                <option value="DC">District Of Columbia</option>
                                <option value="FL">Florida</option>
                                <option value="GA">Georgia</option>
                                <option value="HI">Hawaii</option>
                                <option value="ID">Idaho</option>
                                <option value="IL">Illinois</option>
                                <option value="IN">Indiana</option>
                                <option value="IA">Iowa</option>
                                <option value="KS">Kansas</option>
                                <option value="KY">Kentucky</option>
                                <option value="LA">Louisiana</option>
                                <option value="ME">Maine</option>
                                <option value="MD">Maryland</option>
                                <option value="MA">Massachusetts</option>
                                <option value="MI">Michigan</option>
                                <option value="MN">Minnesota</option>
                                <option value="MS">Mississippi</option>
                                <option value="MO">Missouri</option>
                                <option value="MT">Montana</option>
                                <option value="NE">Nebraska</option>
                                <option value="NV">Nevada</option>
                                <option value="NH">New Hampshire</option>
                                <option value="NJ">New Jersey</option>
                                <option value="NM">New Mexico</option>
                                <option value="NY">New York</option>
                                <option value="NC">North Carolina</option>
                                <option value="ND">North Dakota</option>
                                <option value="OH">Ohio</option>
                                <option value="OK">Oklahoma</option>
                                <option value="OR">Oregon</option>
                                <option value="PA">Pennsylvania</option>
                                <option value="RI">Rhode Island</option>
                                <option value="SC">South Carolina</option>
                                <option value="SD">South Dakota</option>
                                <option value="TN">Tennessee</option>
                                <option value="TX">Texas</option>
                                <option value="UT">Utah</option>
                                <option value="VT">Vermont</option>
                                <option value="VA">Virginia</option>
                                <option value="WA">Washington</option>
                                <option value="WV">West Virginia</option>
                                <option value="WI">Wisconsin</option>
                                <option value="WY">Wyoming</option>
                            </select>
                        </div>
                        <div>
                            <label for="Birthday" class="form-label">Birthday</label>
                            <input type="date" class="form-control" id="Birthday" name="Birthday" />
                        </div>                   
                        <div>
                            <label for="Zipcode" class="form-label">Zipcode</label>
                            <input type="text" class="form-control" id="Zipcode" name="Zipcode" />
                        </div>
                        <div>
                    

                            
                                    <label for="Marital_status" class="form-label">Stage</label>
                                    <select class="form-control" name="Marital_status" id="Marital_status">
                                        @foreach (var item in m_status)
        {
                                <option value="@item.Stage_name">@item.Stage_name</option>
}

                                    </select>
                              
                                 <a href="javascript:void(0)" data-toggle="modal" data-target="#mstatusModal" class="btn btn-success btn-sm">Add new Stage</a>
                          

                        </div>                       
                        <div>
                        
                     
                       
                                    <label for="Source" class="form-label">Source</label>
                                    <select class="form-control" name="Source" id="Source">
                                        @foreach (var item in source)
        {
                                <option value="@item.Source_name">@item.Source_name</option>
}
                                    </select>

                              
                             <a href="javascript:void(0)"  data-toggle="modal" data-target="#sourceModal" class="btn btn-success btn-sm">Add new Source</a> 
                         

                        </div>
                        <div>
                            <label for="Type" class="form-label">Type</label>
                            <select class="form-control" id="Type" name="Type">
                                <option>NOT ASSIGNED</option>
                                <option>BUYER</option>
                                <option>INVESTOR</option>
                                <option>LANDLORD</option>
                                <option>RENTAL</option>
                                <option>SELLER</option>
                                <option>SHORT SALE</option>
                                <option>TENANTS</option>


                            </select>
                        </div>

                        <div class="mt-6">
                            <button type="submit" id="submitbuttoncreate" class="btn btn-primary" >Create new Lead</button>
                        </div>

                    </div>
                </div>
            </div>
        }
        <!-- END: Input -->


    </div>
</div>
<button id="basic-non-sticky-notification-toggle" style="display:none" class="btn btn-primary">Show Notification</button>

<!-- End Container -->
<div class="modal" id="sourceModal">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Add source</h5>
            
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>Source name:</label>
                    <input type="text" class="form-control" id="sourceName" required />
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" id="buttonNewSource">Save</button>
                <button type="button" id="closeButton" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>
<div class="modal" id="mstatusModal">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Add Stage</h5>
             
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>Stage name:</label>
                    <input type="text" class="form-control" id="statusName" required />
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" id="buttonNewStatus">Save</button>
                <button type="button" id="closeButton2" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>


<script type="text/javascript">
    document.getElementById("buttonNewSource").onclick = function () {
        var sourceName = $("#sourceName").val();

        sourceName = sourceName.toUpperCase();

        if (sourceName != "") {
            $.ajax({
                type: "POST",
                url: '@Url.Action("CreateSource","Tb_Source")',
                contentType: 'application/json',
                data: JSON.stringify({
                    source: sourceName
                }),
                success: function (response) {
                    $('#Source').append($('<option>', {

                        value: sourceName,
                        text: sourceName
                    }));
                    var closeModal = $('#closeButton');
                    closeModal.trigger('click');
                    $('#Source').val(sourceName).trigger('change');
                    var link = document.getElementById('basic-non-sticky-notification-toggle');
                    link.click();
                },
                error: function (error) {

                    alert("Error" + error + " " + response);
                    var closeModal = $('#closeButton');
                    closeModal.trigger('click');
                }
            });
        } else {
            alert("This field is mandatory");
        }


    }
        document.getElementById("buttonNewStatus").onclick = function () {
        var statusName = $("#statusName").val();

        statusName = statusName.toUpperCase();
            if (statusName != "") {
                $.ajax({
                    type: "POST",
                    url: '@Url.Action("CreateStatus", "Tb_Status")',
                    contentType: 'application/json',
                    data: JSON.stringify({
                        mstatus: statusName
                    }),
                    success: function (response) {
                        $('#Marital_status').append($('<option>', {

                            value: statusName,
                            text: statusName
                        }));
                        var closeModal = $('#closeButton2');
                        closeModal.trigger('click');
                   
                        $('#Marital_status').val(statusName).trigger('change');

                        var link = document.getElementById('basic-non-sticky-notification-toggle');
                        link.click();
                    },
                    error: function (error) {

                        alert("Error" + error + " " + response);
                        var closeModal = $('#closeButton2');
                        closeModal.trigger('click');
                    }
                });
            } else {
                alert("This field is mandatory");
            }

    }
</script>