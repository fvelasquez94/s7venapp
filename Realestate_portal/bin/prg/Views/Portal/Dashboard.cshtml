@model List<Realestate_portal.Models.Tb_Posts>
@using Realestate_portal.Models;
@{
    ViewBag.Title = "Dashboard";
    Sys_Users user = (Sys_Users)ViewBag.userdata;
    Sys_Users userBroker = (Sys_Users)ViewBag.userdataBroker;
    Sys_Company company = (Sys_Company)ViewBag.userCompany;
    List<Realestate_portal.Models.Sys_Company> lstCompanies = (List<Realestate_portal.Models.Sys_Company>)ViewBag.lstCompanies;
    Google.Apis.Calendar.v3.Data.Events events = (Google.Apis.Calendar.v3.Data.Events)ViewBag.events;
    int days = DateTime.DaysInMonth(DateTime.Today.Year, DateTime.Today.Month);
    int daystart = 1;

}
<div id="basic-non-sticky-notification-content" class="toastify-content hidden flex">
    <i class="text-theme-20" data-feather="check-circle"></i>
    <div class="ml-4 mr-4">
        <div class="font-medium">Data saved successfully!</div>

    </div>
</div>
<div class="grid grid-cols-12 gap-6">
    <div class="col-span-12 2xl:col-span-9">
        <div class="grid grid-cols-12 gap-6">
            <!-- BEGIN: Notification -->
            @*<div class="col-span-12 mt-6 -mb-6 intro-y">
            <div class="alert alert-dismissible show box bg-theme-25 text-white flex items-center mb-6" role="alert">
                <span>Introducing new dashboard!<a href="#" class="underline ml-1" target="blank">themeforest.net</a>.</span>
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"> <i data-feather="x" class="w-4 h-4"></i> </button>
            </div>
        </div>*@
            <!-- BEGIN: Notification -->
            <!-- BEGIN: General Report -->
            <div class="col-span-12 lg:col-span-8 xl:col-span-6 mt-2">
                <div class="intro-y block sm:flex items-center h-10">
                    <h2 class="text-lg font-medium truncate mr-5">
                        Dashboard
                    </h2>

                </div>
                <div class="report-box-2 intro-y mt-12 sm:mt-5">
                    <div class="box sm:flex">
                        <div class="px-8 py-12 flex flex-col justify-center flex-1">
                            <div class="flex flex-1 px-5 items-center justify-center lg:justify-start">
                                <div class="w-20 h-20 sm:w-24 sm:h-24 flex-none lg:w-32 lg:h-32 image-fit relative">
                                    @if (user.Image == "")
                                    {
                                <img alt="S7VEN" class="rounded-full" src="~/Content/dist/images/profile-6.jpg">
                                    }
                                    else
                                    {
                        <img src="@Url.Content(user.Image)" alt="S7VEN" class="rounded-full">
                                    }
                                    <div class="absolute mb-1 mr-1 flex items-center justify-center bottom-0 right-0 bg-theme-25 rounded-full p-2" id="OpenImgUpload" style="cursor:pointer"> <i class="w-4 h-4 text-white" data-feather="camera"></i> </div>
                                </div>
                                <div class="ml-5">
                                    <div class="w-24 sm:w-40 truncate sm:whitespace-normal font-medium text-lg">@user.Name @user.LastName</div>
                                    <div class="text-gray-600">
                                        @if (user.Roles.Contains("Agent"))
                                        {
                                    <span>Real Estate Agent</span>
                                    if (user.Team_Leader) {
                                        <br /><span class="text-theme-20">Team Leader</span>
                                    }
                                        }
                                        else if (user.Roles.Contains("Admin"))
                                        { <span>Broker</span>}
                                        else if (user.Roles.Contains("SA") || user.Roles.Contains("Super User"))
                                        { <span>Super Administrator</span>}
                                    </div>
                                </div>
                                <input type="file" class="img1" id="imgupload" style="display:none" />



                            </div>



                        </div>
                        @*<div class="px-8 py-12 flex flex-col justify-center flex-1 border-t sm:border-t-0 sm:border-l border-gray-300 dark:border-dark-5 border-dashed">
                            <div class="text-gray-600 dark:text-gray-600 text-xs">LISTINGS</div>
                            <div class="mt-1.5 flex items-center">
                                <div class="text-base">0</div>
                                <div class="text-theme-21 flex text-xs font-medium tooltip cursor-pointer ml-2" title="0% Lower than last month"> 0% <i data-feather="chevron-down" class="w-4 h-4 ml-0.5"></i> </div>
                            </div>
                            <div class="text-gray-600 dark:text-gray-600 text-xs mt-5">PROJECTIN GAINS</div>
                            <div class="mt-1.5 flex items-center">
                                <div class="text-base">$0.00</div>
                                <div class="text-theme-20 flex text-xs font-medium tooltip cursor-pointer ml-2" title="0% Higher than last month"> 0% <i data-feather="chevron-up" class="w-4 h-4 ml-0.5"></i> </div>
                            </div>
                            <div class="text-gray-600 dark:text-gray-600 text-xs mt-5">EARNINGS</div>
                            <div class="mt-1.5 flex items-center">
                                <div class="text-base">$0.00</div>
                                <div class="text-theme-20 flex text-xs font-medium tooltip cursor-pointer ml-2" title="0% Higher than last month"> 0% <i data-feather="chevron-up" class="w-4 h-4 ml-0.5"></i> </div>
                            </div>
                            <div class="text-gray-600 dark:text-gray-600 text-xs mt-5">NEW LEADS</div>
                            <div class="mt-1.5 flex items-center">
                                <div class="text-base">0</div>
                                <div class="text-theme-20 flex text-xs font-medium tooltip cursor-pointer ml-2" title="0% Higher than last month"> 0% <i data-feather="chevron-up" class="w-4 h-4 ml-0.5"></i> </div>
                            </div>
                        </div>*@
                    </div>
                </div>
            </div>
            <!-- END: General Report -->
            <!-- BEGIN: Visitors -->
            <div class="col-span-12 sm:col-span-6 lg:col-span-4 xl:col-span-4 mt-2">
                <div class="intro-y flex items-center h-10">


                </div>
                <div class="report-box-2 intro-y mt-5">
                    <div class="box p-5">

                        @if (user.Roles.Contains("Agent") || user.Roles.Contains("Admin"))
                        {
                    <p><strong>Brokerage Name:</strong> @company.Name</p>
                            if (user.Team_Leader == true)
                            {
                                if (user.Leader_Name == "")
                                { <p>Team name: not assigned</p>}
                                else
                                { <p>Team name: @user.Leader_Name</p> }

                            }

                    <p><strong>Address:</strong> @userBroker.Brokerage_address</p>
                    <p><strong>Broker Contact:</strong> @userBroker.Broker_Contact</p>
                    <p><strong>Broker License:</strong> @userBroker.Broker_License</p>
                    <p><strong>My License #:</strong> @user.My_License </p>
                    <p><strong>Member Since:</strong> @user.Member_since.ToShortDateString()</p>
}
else if (user.Roles.Contains("SA") || user.Roles.Contains("Super User"))
{

                    <label>Selected Broker filter: </label>
                    <select class="form-control mt-5" id="selectedBroker" onchange="CambiarBroker(this.value)">
                        @foreach (var broker in lstCompanies)
    {
        if (ViewBag.selbroker == broker.ID_Company)
        {
                    <option selected value="@broker.ID_Company">@broker.Name</option> }
                            else
                            {
                    <option value="@broker.ID_Company">@broker.Name</option>}
                        }
                    </select>
                    <a href="@Url.Action("Brokers", "CRM")" class="btn btn-primary border-dashed w-full py-1 px-2 mt-4">BROKERS LIST</a>
}

                    </div>
                </div>
            </div>
            <!-- END: Visitors -->
            <!-- BEGIN: Users By Age -->
            <div class="col-span-12 sm:col-span-6 lg:col-span-4 xl:col-span-2 mt-2 lg:mt-6 xl:mt-2">
                <div class="intro-y flex items-center h-10">

                  
                </div>
                <div class="report-box-2 intro-y mt-5">
                    <div class="box p-5">

                        @if (company != null)
                        {
                            if (company.Logo != "")
                            {
                                if (company.Logo.StartsWith("http"))
                                {

                                    if (user.Roles.Contains("Agent"))
                                    {
                    <img alt="S7VEN" style="width:200px" src="@company.Logo">
                                    }
                                    else
                                    {
                    <label>Top bar Logo</label> <br /><br />
                    <div class="absolute mb-1 mr-1 flex items-center justify-center bottom-0 right-0 bg-theme-25 rounded-full p-2" id="OpenImgUpload2" style="cursor:pointer"> <i class="w-4 h-4 text-white" data-feather="camera"></i> </div>
                    <input type="file" class="img2" id="imgupload2" style="display:none" />
                    <img alt="S7VEN" style="width:200px" src="@company.Logo">
                                    }

                                }
                                else
                                {
                                    if (user.Roles.Contains("Agent"))
                                    {
                    <img alt="S7VEN" style="width:200px" src="@Url.Content(company.Logo)">
                                    }
                                    else
                                    {
                    <label>Top bar Logo</label> <br /><br />
                    <div class="absolute mb-1 mr-1 flex items-center justify-center bottom-0 right-0 bg-theme-25 rounded-full p-2" id="OpenImgUpload2" style="cursor:pointer"> <i class="w-4 h-4 text-white" data-feather="camera"></i> </div>
                    <input type="file"  class="img2" id="imgupload2" style="display:none" />
                    <img alt="S7VEN" style="width:200px" src="@Url.Content(company.Logo)">
                                    }


                                }
                            }
                            else
                            {
                                if (user.Roles.Contains("Agent"))
                                {

                                }
                                else
                                {
                    <label>Top bar Logo</label> <br /><br />
                    <div class="absolute mb-1 mr-1 flex items-center justify-center bottom-0 right-0 bg-theme-25 rounded-full p-2" id="OpenImgUpload2" style="cursor:pointer"> <i class="w-4 h-4 text-white" data-feather="camera"></i> </div>
                    <input type="file" class="img2" id="imgupload2" style="display:none" />
                    <img alt="S7VEN" style="width:130px;margin-right:20px" src="~/Content/dist/images/logo-1.png">
                                }

                            }
                        }
                        else
                        {
                            if (user.Roles.Contains("Agent"))
                            {

                            }
                            else
                            {
                    <label>Top bar Logo</label> <br /><br />
                    <div class="absolute mb-1 mr-1 flex items-center justify-center bottom-0 right-0 bg-theme-25 rounded-full p-2" id="OpenImgUpload2" style="cursor:pointer"> <i class="w-4 h-4 text-white" data-feather="camera"></i> </div>
                    <input type="file" class="img2" id="imgupload2" style="display:none" />
                    <img alt="S7VEN" style="width:130px;margin-right:20px" src="~/Content/dist/images/logo-1.png">
                            }

                        }
                        
           

                    </div>
                </div>
            </div>
            <!-- END: Users By Age -->
            <!-- BEGIN: Item List -->
            <div class="intro-y col-span-12 lg:col-span-12">
                <div class="lg:flex intro-y">

                    <h2 class="text-lg font-medium truncate mr-5">
                        Modules
                    </h2>


                </div>
                <div class="grid grid-cols-12 gap-5 mt-5">
                    
                        <div class="col-span-12 sm:col-span-4 2xl:col-span-3 box p-5 cursor-pointer zoom-in">
                            <a href="@Url.Action("CRMDashboard", "CRM")">
                                <div class="font-medium text-center">      <i data-feather="users"></i> <br /><br />CRM</div>
                                <div class="text-center">Customer Relationship Manager. Manage your customer data.</div>
                            </a></div>
                   
                        <div class="col-span-12 sm:col-span-4 2xl:col-span-3 box p-5 cursor-pointer zoom-in">
                            <a href="@Url.Action("PGR_network", "Portal")">
                                <div class="font-medium text-center">      <i data-feather="globe"></i> <br /><br />Networking</div>
                                <div class="text-center">Find and Connect with Professionals for a smother transaction.</div>
                                </a>
                        </div>         
    
                        <div class="col-span-12 sm:col-span-4 2xl:col-span-3 box p-5 cursor-pointer zoom-in">
                            <a href="@Url.Action("Documents_upload", "Portal")">
                                <div class="font-medium text-center">      <i data-feather="archive"></i> <br /><br />Documents History</div>
                                <div class="text-center">Upload all your transaction documents.</div>
                                </a>
                        </div>
                        <div class="col-span-12 sm:col-span-4 2xl:col-span-3 box p-5 cursor-pointer zoom-in">
                            <a href="@Url.Action("Resources", "Portal")">
                                <div class="font-medium text-center">      <i data-feather="box"></i> <br /><br />General Resources</div>
                                <div class="text-center">Access to all MLS forms, Scripts and more.</div>
                                </a>
                        </div>
                        <div class="col-span-12 sm:col-span-4 2xl:col-span-3 box p-5 cursor-pointer zoom-in">
                            <a href="@Url.Action("Videos", "Portal")" target="_blank">
                                <div class="font-medium text-center">      <i data-feather="tv"></i> <br /><br />Videos</div>
                                <div class="text-center">Training videos.</div>
                                </a>
                        </div>
                        <div class="col-span-12 sm:col-span-4 2xl:col-span-3 box p-5 cursor-pointer zoom-in">
                            <a href="@Url.Action("Index", "Market")">
                                <div class="font-medium text-center">      <i data-feather="briefcase"></i> <br /><br />Marketing</div>
                                <div class="text-center">Everything to market your business.</div>
                                </a>
                        </div>
                        <div class="col-span-12 sm:col-span-4 2xl:col-span-3 box p-5 cursor-pointer zoom-in">
                            <a href="@Url.Action("Webinar", "Portal")">
                                <div class="font-medium text-center">      <i data-feather="calendar"></i> <br /><br />Webinars</div>
                                <div class="text-center">Stay up to date with all 7 events and access to live trainings.</div>
                                </a>
                        </div>     
                    <div class="col-span-12 sm:col-span-4 2xl:col-span-3 box p-5 cursor-pointer zoom-in">
                            <a href="https://www.worknetify.com/" target="_blank">
                                <div class="font-medium text-center">      <i data-feather="layers"></i> <br /><br />Bookings</div>
                                <div class="text-center">Reserve your work space.</div>
                                </a>
                        </div>

                </div>

            </div>
            <!-- END: Item List -->
            <!-- BEGIN: Official Store -->
            <!-- END: Official Store -->
            <!-- BEGIN: Weekly Best Sellers -->
            <!-- END: Weekly Best Sellers -->
            <!-- BEGIN: Ads 1 -->
  
                <div class="col-span-12 lg:col-span-6 mt-6">
                    <div class="ads-box box p-8 relative overflow-hidden intro-y">
                        <div class="ads-box__title w-full sm:w-52 text-theme-24 dark:text-white text-xl -mt-3">One of the largest and most accurate multiple listing service in New York State</div>
                        <div class="w-full sm:w-72 leading-relaxed text-gray-600 mt-3"></div>

                        <a href="https://www.lirealtor.com/" target="_blank" class="btn w-32 bg-white dark:bg-dark-2 dark:text-white mt-6 sm:mt-10">Your MLS</a>
                        <img class="absolute bottom-0 right-0  mt-1 -mr-12" style="width:70%" alt="S7VEN" src="~/Content/dist/images/Marketanalysis.png">
                    </div>
                </div>
                <div class="col-span-12 lg:col-span-6 mt-6">
                    <div class="ads-box box p-8 relative overflow-hidden bg-theme-24 intro-y">
                        <div class="ads-box__title w-full sm:w-72 text-white text-xl -mt-3">Take a look at <br />our <span class="font-medium">Comparative  Market <br />Analysis</span> Partner <br /> <br /></div>
                        <a href="https://www.narrpr.com/home?cbcode=NYMLS-N" target="_blank" class="btn w-32 bg-white dark:bg-dark-2 dark:text-white mt-6 sm:mt-10">Your CMA</a>
                        <img class="absolute bottom-0 right-0 w-2/5 -mt-3 mr-2" alt="S7VEN" src="~/Content/dist/images/phone-illustration.svg">

                    </div>
                </div>
     

            <!-- END: Ads 1 -->
            <!-- BEGIN: Ads 2 -->
            <!-- END: Ads 2 -->
            <!-- BEGIN: Weekly Top Products -->
            <!-- END: Weekly Top Products -->
        </div>
        </div>
    <div class="col-span-12 2xl:col-span-3">
        <div class="2xl:border-l border-theme-31 -mb-10 pb-10">
            <div class="2xl:pl-6 grid grid-cols-12 gap-6">
                <!-- BEGIN: Important Notes -->
                <div class="col-span-12 md:col-span-6 xl:col-span-12 mt-3 2xl:mt-8">
                    <div class="intro-x flex items-center h-10">
                        <h2 class="text-lg font-medium truncate mr-auto">
                            News Feed
                        </h2>
                        <button data-carousel="important-notes" data-target="prev" class="tiny-slider-navigator btn px-2 border-gray-400 text-gray-700 dark:text-gray-300 mr-2"> <i data-feather="chevron-left" class="w-4 h-4"></i> </button>
                        <button data-carousel="important-notes" data-target="next" class="tiny-slider-navigator btn px-2 border-gray-400 text-gray-700 dark:text-gray-300 mr-2"> <i data-feather="chevron-right" class="w-4 h-4"></i> </button>
                    </div>
                    <div class="mt-5 intro-x">
                        <div class="box zoom-in">
                            <div class="tiny-slider" id="important-notes">
                                <div class="p-5">
                                    <div class="text-base font-medium truncate">Quote of the day</div>

                                    <div class="text-gray-600 text-justify mt-1">"@ViewBag.quote"</div>
                                    <div class="text-gray-500 mt-1">-@ViewBag.author</div>
                                </div>
                                <div class="p-5">
                                    @if (ViewBag.rol == "Agent" || ViewBag.rol == "Admin")
                                    {
                                        if (Model.Count > 0)
                                        {
                                            foreach (var item in Model.Where(c => c.Active == true && c.Post_type == 1))
                                            {

                                <div class="text-base font-medium truncate">Broker message: @item.Title</div>
                                <div class="text-gray-500 mt-1">@item.created_at.ToString("ddd"), @item.created_at.ToString("MMMM") @item.created_at.ToString("dd"), @item.created_at.Year </div>
                                <div class="text-gray-600 text-justify mt-1">@item.Content_post</div>
                                <div class="font-medium flex mt-5">
                                    @*<button type="button" class="btn btn-secondary py-1 px-2">View more</button>*@
                                    @if (ViewBag.rol != "Agent")
                                    {
                                <a href="@Url.Action("Index", "Posts")" class="btn btn-success py-1 px-2">Messages</a>
                                    }


                                </div>


                                            }

                                        }
                                        else
                                        {
                                <div class="text-base font-medium truncate">Broker message</div>
                                <div class="text-gray-500 mt-1"></div>
                                <div class="text-gray-600 text-justify mt-1">No message from Broker</div>
                                            if (ViewBag.rol != "Agent")
                                            {
                                <a href="@Url.Action("Index", "Posts")" class="btn btn-success py-1 px-2">Messages</a>
                                            }

                                        }
                                    }

                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- END: Important Notes -->
                <!-- BEGIN: Schedules -->
                <div class="col-span-12 md:col-span-6 xl:col-span-4 2xl:col-span-12 mt-3">
                    <div class="intro-x flex items-center h-10">
                        <h2 class="text-lg font-medium truncate mr-5">
                            Coming soon Webinars
                        </h2>
                    </div>
                    <div class="mt-5">
                        <div class="intro-x box">
                            <div class="p-5">
                                <div class="flex">
                                 
                                    <div class="font-medium text-base mx-auto">@DateTime.Today.ToString("MMMM")</div>
                                   
                                </div>
                                <div class="grid grid-cols-7 gap-4 mt-5 text-center">
                                    <div class="font-medium">Sun</div>
                                    <div class="font-medium">Mon</div>
                                    <div class="font-medium">Tue</div>
                                    <div class="font-medium">Wed</div>
                                    <div class="font-medium">Thu</div>
                                    <div class="font-medium">Fri</div>
                                    <div class="font-medium">Sat</div>
                                    @if (new DateTime(DateTime.Today.Year, DateTime.Today.Month, 1).ToString("ddd") == "Sun")
                                            {
                                                daystart = 8;
                                    <div class="py-0.5 rounded relative">1</div>
                                    <div class="py-0.5 rounded relative">2</div>
                                    <div class="py-0.5 rounded relative">3</div>
                                    <div class="py-0.5 rounded relative">4</div>
                                    <div class="py-0.5 rounded relative">5</div>
                                    <div class="py-0.5 rounded relative">6</div>
                                    <div class="py-0.5 rounded relative">7</div>
                                    
                                    }
                                        @if (new DateTime(DateTime.Today.Year, DateTime.Today.Month, 1).ToString("ddd") == "Mon")
                                        {
                                            daystart = 7;
                                    <div class="py-0.5 rounded relative"></div>
                                    <div class="py-0.5 rounded relative">1</div>
                                    <div class="py-0.5 rounded relative">2</div>
                                    <div class="py-0.5 rounded relative">3</div>
                                    <div class="py-0.5 rounded relative">4</div>
                                    <div class="py-0.5 rounded relative">5</div>
                                    <div class="py-0.5 rounded relative">6</div>
                                        }
                                              @if (new DateTime(DateTime.Today.Year, DateTime.Today.Month, 1).ToString("ddd") == "Tue")
                                              {
                                                  daystart = 6;
                                    <div class="py-0.5 rounded relative"></div>
                                    <div class="py-0.5 rounded relative"></div>
                                    <div class="py-0.5 rounded relative">1</div>
                                    <div class="py-0.5 rounded relative">2</div>
                                    <div class="py-0.5 rounded relative">3</div>
                                    <div class="py-0.5 rounded relative">4</div>
                                    <div class="py-0.5 rounded relative">5</div>
                                              }
                                    
                                                              @if (new DateTime(DateTime.Today.Year, DateTime.Today.Month, 1).ToString("ddd") == "Wed")
                                                              {
                                                                  daystart = 5;
                                    <div class="py-0.5 rounded relative"></div>
                                    <div class="py-0.5 rounded relative"></div>
                                    <div class="py-0.5 rounded relative"></div>
                                    <div class="py-0.5 rounded relative">1</div>
                                    <div class="py-0.5 rounded relative">2</div>
                                    <div class="py-0.5 rounded relative">3</div>
                                    <div class="py-0.5 rounded relative">4</div>
                                                              }
                                                                                   @if (new DateTime(DateTime.Today.Year, DateTime.Today.Month, 1).ToString("ddd") == "Thu")
                                                                                   {
                                                                                       daystart = 4;
                                    <div class="py-0.5 rounded relative"></div>
                                    <div class="py-0.5 rounded relative"></div>
                                    <div class="py-0.5 rounded relative"></div>
                                    <div class="py-0.5 rounded relative"></div>
                                    <div class="py-0.5 rounded relative">1</div>
                                    <div class="py-0.5 rounded relative">2</div>
                                    <div class="py-0.5 rounded relative">3</div>
                                                                                   }

                                                                                   @if (new DateTime(DateTime.Today.Year, DateTime.Today.Month, 1).ToString("ddd") == "Fri")
                                                                                   {
                                                                                       daystart = 3;
                                    <div class="py-0.5 rounded relative"></div>
                                    <div class="py-0.5 rounded relative"></div>
                                    <div class="py-0.5 rounded relative"></div>
                                    <div class="py-0.5 rounded relative"></div>
                                    <div class="py-0.5 rounded relative"></div>
                                    <div class="py-0.5 rounded relative">1</div>
                                    <div class="py-0.5 rounded relative">2</div>
                                                                                   }

                                                                                   @if (new DateTime(DateTime.Today.Year, DateTime.Today.Month, 1).ToString("ddd") == "Sat")
                                                                                   {
                                                                                       daystart = 2;
                                    <div class="py-0.5 rounded relative"></div>
                                    <div class="py-0.5 rounded relative"></div>
                                    <div class="py-0.5 rounded relative"></div>
                                    <div class="py-0.5 rounded relative"></div>
                                    <div class="py-0.5 rounded relative"></div>
                                    <div class="py-0.5 rounded relative"></div>
                                    <div class="py-0.5 rounded relative">1</div>
                                                                                   }

                                    @for (var i = daystart; i <= days; i++)
                                    {

                                        if (events != null)
                                        {
                                            if (events.Items != null)
                                            {
                                                if (events.Items.Where(c => c.Start.DateTime.Value.Day == i).Count() > 0)
                                                {
                                                                                                          
                                                    <div class="py-0.5 bg-theme-19 rounded relative">@i</div>
                                                }
                                                else {
                                                      <div class="py-0.5 rounded relative">@i</div>
                                                }
                                            }
                                            else {
                                                  <div class="py-0.5 rounded relative">@i</div>
                                            }
                                        }
                                        else {
                                              <div class="py-0.5 rounded relative">@i</div>
                                        }
                                    }

                                </div>
                            </div>
                            <div class="border-t border-gray-200 p-5">
                                @if (events != null) {
                                    if (events.Items != null) {
                                        if (events.Items.Count() > 0) {
                                            foreach (var item in events.Items.Take(8)) {
                                                <div class=" mt-3">
                                        
                                                     <a href="@item.HtmlLink" target="_blank">- @item.Summary</a>
                                               
                                                     <span class="font-medium xl:ml-auto text-theme-20">(@item.Start.DateTime.Value.ToString("ddd") @item.Start.DateTime.Value.ToString("dd"))</span>
                                                 </div>
                                            }
                                        }
                                    }
                                }
                             
                                <a class="btn btn-primary mt-5" href="@Url.Action("Webinar","Portal")">Show more</a>
                                
                            </div>
                        </div>
                    </div>
                </div>

                <!-- END: Schedules -->
            </div>
        </div>
    </div>
</div>

<button id="basic-non-sticky-notification-toggle" style="display:none" class="btn btn-primary">Show Notification</button>
<script type="text/javascript">


    //const settings2 = {
    //    "async": true,
    //    "crossDomain": true,
    //    "url": "https://type.fit/api/quotes",
    //    "method": "GET"
    //}
    window.onload = function () {
        //$.ajax(settings2).done(function (response) {
        //    const data = JSON.parse(response);
        //    var items = data;
        //    const replacer = (key, value) => value === null ? '' : value; // specify how you want to handle null values here
        //    const header = Object.keys(items[0]);
        //    let csv = items.map(row => header.map(fieldName => JSON.stringify(row[fieldName], replacer)).join(','));
        //    csv.unshift(header.join(','));
        //    csv = csv.join('\r\n');

        //    //Download the file as CSV
        //    var downloadLink = document.createElement("a");
        //    var blob = new Blob(["\ufeff", csv]);
        //    var url = URL.createObjectURL(blob);
        //    downloadLink.href = url;
        //    downloadLink.download = "DataDump.csv";  //Name the file here
        //    document.body.appendChild(downloadLink);
        //    downloadLink.click();
        //    document.body.removeChild(downloadLink);
        //});



        $('#OpenImgUpload').click(function () { $('#imgupload').trigger('click'); });
        $('#OpenImgUpload2').click(function () { $('#imgupload2').trigger('click'); });


        $('input[type="file"].img1').change(function () {
               var fileData = new FormData();
            var iduser = @user.ID_User;
            var file = document.getElementById("imgupload").files[0];


        // Adding one more key to FormData object
            fileData.append('id', iduser);
            fileData.append("imgupload", file);

        //if true rotate to the right
        //$('#maindivprogress_' + ID).show();
        $.ajax({
            url: '/Users/changeProfilePicture',
            //xhr: function () {
            //    var xhr = new window.XMLHttpRequest();
            //    xhr.upload.addEventListener("progress", function (evt) {
            //        if (evt.lengthComputable) {
            //            var percentComplete = (evt.loaded / evt.total) * 100;

            //            $('#divprogress_' + ID).width(percentComplete + '%');
            //            $('#imgprogress_' + ID).html(percentComplete.toFixed(2) + "%");

            //        }
            //    }, false);
            //    return xhr;
            //},
            type: "POST",
            contentType: false, // Not to set any content header
            processData: false, // Not to process data
            //async: true,
            timeout: 80000,
            data: fileData,
            success: function (result) {
                //$("#modal_demoform_saving").modal('hide');
                if (result == "SUCCESS") {
                    var link = document.getElementById('basic-non-sticky-notification-toggle');
                    link.click();
                    window.location.reload(true);
                } else {
                    console.log(result);
                }
                //$("#loading").hide();
            },
            error: function (jqXHR, textStatus, errorThrown) {
                alert("Error uploading image. " + errorThrown );
            }
        });
        });


        $('input[type="file"].img2').change(function () {
               var fileData = new FormData();
            var iduser = @company.ID_Company;
            var file = document.getElementById("imgupload2").files[0];


        // Adding one more key to FormData object
            fileData.append('id', iduser);
            fileData.append("imgupload", file);

        //if true rotate to the right
        //$('#maindivprogress_' + ID).show();
        $.ajax({
            url: '/Sys_Company/changeCompanyImg',
            //xhr: function () {
            //    var xhr = new window.XMLHttpRequest();
            //    xhr.upload.addEventListener("progress", function (evt) {
            //        if (evt.lengthComputable) {
            //            var percentComplete = (evt.loaded / evt.total) * 100;

            //            $('#divprogress_' + ID).width(percentComplete + '%');
            //            $('#imgprogress_' + ID).html(percentComplete.toFixed(2) + "%");

            //        }
            //    }, false);
            //    return xhr;
            //},
            type: "POST",
            contentType: false, // Not to set any content header
            processData: false, // Not to process data
            //async: true,
            timeout: 80000,
            data: fileData,
            success: function (result) {
                //$("#modal_demoform_saving").modal('hide');
                if (result == "SUCCESS") {
                    var link = document.getElementById('basic-non-sticky-notification-toggle');
                    link.click();
                    window.location.reload(true);
                } else {
                    console.log(result);
                }
                //$("#loading").hide();
            },
            error: function (jqXHR, textStatus, errorThrown) {
                alert("Error uploading image. " + errorThrown );
            }
        });
        });
    };






    var like = @ViewBag.likepost;
    var showcomm = 0;
    function showcomments() {
        if (showcomm == 0) {
            $("#commentshide").show();
            showcomm = 1;
        } else {
            $("#commentshide").hide();
            showcomm = 0;
        }

    }

    function likepost() {
        if (like == 0) {


            var id_parentPost = @ViewBag.idparentpost;

        $.ajax({
            type: "POST",
            url: '/Portal/Likepost',
            data: JSON.stringify({
                id: id_parentPost
            }),
            datatype: 'application/json',
            contentType: 'application/json',
            processData: false,
            success: function (response) {
                if (response == "SUCCESS") {

                    like = 1;
                    $("#likeposticon").removeClass('la-heart-o');
                    $("#likeposticon").addClass('la-heart');
                    $("#textlike").show();

                    var numl = parseInt($("#numlikes").html());
                    var numl = numl + 1;
                    $("#numlikes").html(numl);

                } else {

                    alert(response);
                }
            },
            error: function (error) {

                alert("Error posting comment");
            }
        });


        } else {

                        var id_parentPost = @ViewBag.idparentpost;

        $.ajax({
            type: "POST",
            url: '/Portal/Dislikepost',
            data: JSON.stringify({
                id: id_parentPost
            }),
            datatype: 'application/json',
            contentType: 'application/json',
            processData: false,
            success: function (response) {
                if (response == "SUCCESS") {

                    like = 0;
                    $("#likeposticon").addClass('la-heart-o');
                    $("#likeposticon").removeClass('la-heart');
                    $("#textlike").hide();

                    var numl = parseInt($("#numlikes").html());
                    var numl = numl -1;
                    $("#numlikes").html(numl);

                } else {

                    alert(response);
                }
            },
            error: function (error) {

                alert("Error posting comment");
            }
        });


        }

    }

    function saveComment() {

        var comment = $.trim($("#commentposttext").val());
        var id_parentPost = @ViewBag.idparentpost;
        $("#btnpostcomment").attr("disabled", true);
        $.ajax({
            type: "POST",
            url: '/Portal/Postcomment',
            data: JSON.stringify({
                comment: comment,
                id: id_parentPost
            }),
            datatype: 'application/json',
            contentType: 'application/json',
            processData: false,
            success: function (response) {
                if (response == "SUCCESS") {

                    $("#btnpostcomment").attr("disabled", false);
                    var numl = parseInt($("#numcomments").html());
                    var numl = numl + 1;
                    $("#numcomments").html(numl);
                    window.location.reload(true);
                } else {
                    $("#btnpostcomment").attr("disabled", false);
                    alert(response);
                }
            },
            error: function (error) {
                $("#btnpostcomment").attr("disabled", false);
                alert("Error posting comment");
            }
        });
    }

</script>